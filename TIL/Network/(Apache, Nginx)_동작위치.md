# 웹 서버 (Apache, Nginx) 는 OSI 7 계층 중 어디서 작동하는지
---
### | Nginx ?   
HTTP 프로토콜을 이용하여 html 데이터를 클라이언트에게 제공해 주는 서버이다. 
HTTP 프로토콜 중 `OSI 7계층인 application layer` .에 위치하며 
브라우저(클라이언트)와 서버 사이에 정보를 주고 받기 위한 프로토콜(약속)으로 사용된다. 
웹 서버의 종류로는 <mark>Nginx 와 Apache</mark> 가 있다. 

nginx는 apache 와는 다른 방식의 웹 서버이다.
* Event Drvien 방식으로 동작 (요청이 들어오면 어떤 동작을 해야하는지 알려주고 다른 요청 처리 `비동기 방식`)
* apache 의 C10K problem(한 웹서버에 10000개의 클라이언트의 접속을 동시에 다룰수 있는 기술적 문제) 해결
* 다수의 연결을 효과적으로 처리
* event-driven 방식이라 가벼움. 

경량화된 웹 서버로 ==single thread 로 작동하며 비동기 non-blocking I/O 이벤트 기반 요청 처리==를 한다.
그래서 적은 자원으로 효율적인 트래픽 처리가 가능하다. 
(멀티 스레드 경우 스레드가 생성되고 context-switching 횟수가 증가하여 자원이 낭비될수 있다.)

클링언트로부터 요청을 받았을떼 `WAS 를 거치지 않고 요청에 맞는 정적인 파일을 응답해`주는 HTTP server 로서 활용하고 HTML, CSS 처리에 대한것이 예이다. 

> Q) 웹 서버 소프트웨어(Apache, Nginx)는 OSI 7계층 중 어디서 작동하는지 설명해보세요.

웹 서버는 HTTP 프로토콜을 사용해 html 데이터를 클라이언트에 제공하는 서버입니다. 그리고 HTTP 프로토콜은 OSI 7계층인 Application Layer에 위치해 있습니다. 브라우저와 서버 사이에 정보를 주고받기 위해 사용하며, Apache, Nginx는 웹 서버 중의 하나이므로 Applicaion 계층에서 작동합니다.

  

> Q) 웹 서버 소프트웨어(Apache, Nginx)의 서버 간 라우팅 기능은 OSI 7계층 중 어디서 작동하는지 설명해보세요.

라우터는 다른 네트워크와 통신하기 위해 사용하는 장치로, 현재의 네트워크에서 다른 네트워크로 패킷을 전송합니다. 따라서 서버 간 라우팅 기능은 네트워크 계층에서 동작합니다.

||  네트워크 계층 (3 계층)

keyword: 주소부여(IP), 경로 설정(route)
==데이터를 목적지까지 안전하고 빠르게 전달하는 기능(라우팅)==을 담당하고 있다. 
경로를 선택하고 주소를 정하고 경로에 따라 팻킷을 전달해주는 계층이다. 
대표적 장비는 `라우터` 이며 ==라우팅, 흐름제어, 세그멘테이션(segmentation/desegmentation), 오류 제어, 인터네트워킹(itnernetoworking)== 등을 수행한다. 
데이터를 연결하는 다른 네트워크를 통해 전달함으로써 인터넷을 가능하게 만들며 IP 를 관리자가 직접 주소를 할당하는 구조로 계층적이다(hierarchical). 

- IP 계층 : TCP/IP 상 네트워크 주소를 정의하고 ==IP 패킷의 전달 및 라우팅을 담당하는 계층== 이다. 하위 계층인 데이터링크 계층의 하드웨어적 틍성관계없이 독립적인 역할을 수행한다. 
	- 주요 프로토콜 
		- 패킷의 전달을 책임지는 IP
		- 패킷 전달 에러의 보고 및 진단을 위한 ICMP 
		- 복잡한 네트워크에서 인터네트워킹을 위한 경오를 찾게해주는 라우팅 프로토콜 

* IP 프로토콜 : `routing/ addressing` 
	* 신뢰성 및 흐름제어 기능이 없어 신뢰성 확보를 위해 TCP 와 같은 상위 트랜스포트 계층에 의존 필요하다. 

계층 예시]
APSTNDP - application/presentation/service/transport/network/data-link/physical 

### | 로드 밸런싱 
서버의 부하(Load)를 분산시키는 기술이다. 
사이트에 접속해서 해당 서버의 트래픽이 늘어날때 여러 대의 서버를 이용해서 요청 처리를 기다린다. 
각 서버의 부하량, 속도 등을 고려해 서버의 가중치, 스케쥴링 등을 결정해 트래픽을 적절히 분산시키는 과정이다.

- 장점 
	- 값싼 비용으로 다수의 서버를 증설하여 관리할수 있기에 고가의 서버를 구매하지 않아도 된다. 
	- 1대의 서버가 멈춰도 중단되지 않는다
	- 서버를 늘리는 과정에서도 서비스가 중단되지 않는다. 
- nginx 제공 
	- round robin : 순차적으로 돌아가면서 진행
	- least-connected : 현재 접속자 수가 가장 적은 서버 선택
	- ip-hash : has function 이용 클라이어트 ip 를 hash 한 결과 따라 다른 서버를 할당
		-  ip_hash method는 backup 서버를 지원하지 않는다고 명시