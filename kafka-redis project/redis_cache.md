## 캐시 ? 
 캐시는, 접근 비용이 비싼 데이터의 사본을 만들어 저장하고, 동일한 요청이 있을 때 원본 데이터에 접근하지 않고 사본 데이터를 제공할 수 있게 하는 중간 장치의 개념입니다.

 
네트워크 통신, 하드 디스크 접근 등 컴퓨터 시스템의 곳곳에서 병목이 일어날 수 있을만한 지점의 성능 향상을 위해 캐시를 사용하곤 합니다.  

</br> 

## Redis Cache 성능 조회 

💡EX) 상대방의 정보를 조회하는 API가 한번 호출되었다면, 해당 데이터를 임시로 저장소에 그대로 저장한다. 그 이후 클라이언트가 해당 정보를 요청하는 API가 다시 호출이 된다면 별도의 연산 없이 임시에 저장된 데이터를 바로 읽어와서 응답하여 성능과 속도가 개선된다

> Cache를 사용하기위해 고려해야하는 부분
- 별도의 연산 수행이 없이 동일한 응답 값을 전달할 수 있어야함
- 어떤 기준으로 Cache를 적용할지 결정해야함
- Cache의 유지 기간을 고려해야함
- 저장공간에 대한 설계


- 데이터 캐시화: 자주 액세스되는 데이터를 레디스에 캐시로 저장합니다. 이는 데이터베이스 쿼리 또는 계산이 필요한 작업을 수행하기 전에 먼저 레디스에 데이터가 있는지 확인하고, 있다면 데이터를 반환하는 방식으로 사용됩니다.

-  캐시 키 디자인: 캐시 키는 레디스에서 데이터를 고유하게 식별하는 데 사용됩니다. 캐시 키를 잘 설계하면 데이터를 빠르게 검색할 수 있습니다. 캐시 키에는 액세스 패턴, 데이터의 특성 및 식별자 등을 고려하여 적절한 방식으로 설계해야 합니다.

- 만료 시간 설정: 캐시된 데이터는 메모리를 점유하므로 메모리 관리를 위해 적절한 만료 시간을 설정해야 합니다. 자주 업데이트되는 데이터는 짧은 만료 시간을 설정하고, 거의 변경되지 않는 데이터는 긴 만료 시간을 설정하는 것이 좋습니다.

- 데이터 무효화(Invalidation): 데이터가 업데이트되거나 삭제될 때 캐시에서 해당 데이터를 무효화해야 합니다. 이를 위해 적절한 무효화 전략을 사용해야 합니다. 예를 들어, 데이터베이스에서 데이터가 업데이트될 때 캐시


> Cache는 주로 어디에 사용할까?
- Content에 대한 정보 조회와 같은 상황
- 즉시 메시지를 주고 받아야 될 때
- 장바구니의 삭제
- ⭐️자주 호출되면서 업데이트를 많이 하지 않는 데이터들로 구성    

[예시] 

메인 화면은 내 주변 지역의 이벤트 목록/카테고리별 이벤트 목록 입니다. 서비스의 점차 규모가 커지고 그에 따라 사용자의 수는 늘어나게 됩니다. 증가한 사용자 만큼 수 천, 또는 수 만개의 이벤트 목록을 불러올 때 매번 DB까지 도달하여 읽어오게 된다면 성능적인 이슈가 발생할 수 밖에 없었습니다.  

! 이유?   
한번 읽어온 조회결과를 복사하여 메모리에 저장해둔다면 매번 DB로부터 호출하지 않고 메모리로 부터 값을 가져오기 때문에 DB의 부하를 줄이며동시에 속도 향상의 결과를 볼 수 있기 때문에 조회 기능에 캐싱을 적용해보기로 결정하게 되었습니다!    

- 캐싱 종류 : Local Cache VS Global Cache  
- Local Cache 란?  
    -  캐시 전략 중에 하나이며 서버에 저장하는게 아닌 클라이언트 로컬 영역에 캐시 데이터를 저장하는 것을 의미합니다. Local cache 를 이용하게 된다면 서버로 데이터 통신을 위한 대기 시간이 없기 때문에 응답속도가 빠릅니다. 또한 데이터의 쓰기가 한번씩만 발생하기 때문에 네트워크 트래픽 또한 줄일 수 있는 장점이 있습니다.

    - 그러나 각각의 was 마다 캐시를 저장하기 때문에 하나의 장비에만 저장이 됩니다. 그리고 서버에 저장하는 것이 아니기 때문에 다른 서버에서 참조하기가 어렵습니다.  

- Global Cache 란? 
    - Local Cache와 다르게 서버에 캐시 데이터를 저장합니다. 따라서 여러 대의 서버를 이용할 때 서버 간의 데이터 동기화가 용이하며 트래픽의 분산 또한 가능합니다. 그러나 서버와 네트워크 통신이 이루어지기 때문에 Local Cache보다 속도가 느리다는 단점이 존재합니다.

> Cache 의 전략  
- Look Aside + Write Around 전략 
    - Look Aside 패턴
        - Cache Aside 패턴이라고도 불림.
        - 데이터를 찾을때 우선 캐시에 저장된 데이터가 있는지 우선적으로 확인하는 전략. 만일 캐시에 데이터가 없으면 DB에서 조회함.
        - 반복적인 읽기가 많은 호출에 적합.
        - 캐시와 DB가 분리되어 가용되기 때문에 원하는 데이터만 별도로 구성하여 캐시에 저장
        - 캐시와 DB가 분리되어 가용되기 때문에 캐시 장애 대비 구성이 되어있음.만일 redis가 다운 되더라도 DB에서 데이터를 가져올수 있어 서비스 자체는 문제가 없음.
        - 대신에 캐시에 붙어있던 connection이 많았다면, redis가 다운된 순간 순간적으로 DB로 몰려서 부하 발생.

        -  방식은 캐시에 장애가 발생하더라도 DB에 요청을 전달함으로써 캐시 장애로 인한 서비스 문제는 대비할수 있지만, Cache Store와 Data Store(DB)간 정합성 유지 문제가 발생할 수 있으며, 초기 조회 시 무조건 Data Store를 호출 해야 하므로 단건 호출 빈도가 높은 서비스에 적합하지 않다. 대신 반복적으로 동일 쿼리를 수행하는 서비스에 적합한 아키텍처이다.  

    - Write Around 패턴  
        - Write Through 보다 훨씬 빠름 
            - write through : 데이터베이스와 Cache에 동시에 데이터를 저장하는 전략
        - 모든 데이터는 DB에 저장 (캐시를 갱신하지 않음)
        - Cache miss가 발생하는 경우에만 DB와 캐시에도 데이터를 저장
        - 따라서 캐시와 DB 내의 데이터가 다를 수 있음 (데이터 불일치)  

- [전략모음](https://inpa.tistory.com/entry/REDIS-%F0%9F%93%9A-%EC%BA%90%EC%8B%9CCache-%EC%84%A4%EA%B3%84-%EC%A0%84%EB%9E%B5-%EC%A7%80%EC%B9%A8-%EC%B4%9D%EC%A0%95%EB%A6%AC)  




[참고]  
- [look aside 실습](https://velog.io/@hwsa1004/Spring-Redis-Cache%EB%A5%BC-%ED%86%B5%ED%95%B4-%EC%84%B1%EB%8A%A5-%EA%B0%9C%EC%84%A0%ED%95%98%EA%B8%B0)  
- [캐싱관련 기본](https://jane096.github.io/project/redis-caching/)  
- [캐싱 예제](https://souljit2.tistory.com/72)  
- [우아한 Redis 정리](https://blog.naver.com/PostView.naver?blogId=qjawnswkd&logNo=222334452233&categoryNo=8&parentCategoryNo=0&viewDate=&currentPage=1&postListTopCurrentPage=1&from=search)  
- [개발자를 위한 redis tutorial](https://medium.com/garimoo/%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%A0%88%EB%94%94%EC%8A%A4-%ED%8A%9C%ED%86%A0%EB%A6%AC%EC%96%BC-02-f1029893e263)  
    - 좋아요 set 으로 구현
    - 일일 방문자 수 구하기 
- [상품 재고 관리 redis](https://techblog.woowahan.com/2709/) 
- [가게 노출 시스템](https://techblog.woowahan.com/2667/) 
- [CQRS 구조 시스템](https://techblog.woowahan.com/2587/)
    - Spring Rest Docs 
    - 브랜치 전략
    - HTTP API 테스트 (postman 사용) =>  IntelliJ의 .http를 [IntelliJ .http](https://jojoldu.tistory.com/266)